âš ï¸ â˜ "ä½ çš„è®¢é˜…è¿æ¥#emoji=1&tfo=1&in=é¦™æ¸¯+å°æ¹¾"
â– æœ¬åœ°èµ„æºç‰‡æ®µå¼•ç”¨, è¯·å°†å‚æ•°å¦‚ "#in=xxx&out=yyy" å¡«å…¥èµ„æºç‰‡æ®µçš„ç¬¬ â‘  è¡Œ
â– ğŸš¦ æ”¯æŒä¸­æ–‡, "æ“ä½œ" ä»¥ä¸‹ç‰¹æ®Šå­—ç¬¦æ—¶è¯·å…ˆæ›¿æ¢(URL-Encode) ğŸš¦
  âˆ "+"â‡’"%2B", ç©ºæ ¼â‡’"%20", "@"â‡’"%40", "&"â‡’"%26", "."â‡’"\.", ","â‡’"%2C"

1ï¸âƒ£ âŸ¦ğ¬ğğ«ğ¯ğğ« èŠ‚ç‚¹âŸ§ â  å‚æ•°è¯´æ˜:
â¦¿ emoji=1(å›½è¡Œè®¾å¤‡ç”¨2)/-1, æ·»åŠ /åˆ é™¤èŠ‚ç‚¹åå†…åœ°åŒºæ——å¸œ;
â¦¿ udp=1/-1, tfo=1/-1, åˆ†åˆ«å¼ºåˆ¶å¼€å¯(å…³é—­) ğ®ğğ©-ğ«ğğ¥ğšğ²/ğŸğšğ¬ğ­-ğ¨ğ©ğğ§;
â¦¿ uot=1, å¼€å¯ udp-over-tcp=trueé€‰é¡¹ï¼ˆä»…é™SS(R)ï¼‰
â¦¿ cert=1/-1, åˆ†åˆ«å¼€å¯/å…³é—­ ğ­ğ¥ğ¬ è¯ä¹¦éªŒè¯(é»˜è®¤å…³é—­);
  â– csha/psha, tls-cert-sha256 ä»¥åŠ tls-pubkey-sha256 å‚æ•°
  â– alpn, æŒ‡å®šover-tlsç±»å‹èŠ‚ç‚¹çš„alpnå‚æ•°
â¦¿ in, out, regex, regout åˆ†åˆ«ä¸º ä¿ç•™ã€åˆ é™¤ã€æ­£åˆ™ä¿ç•™ã€æ­£åˆ™åˆ é™¤ èŠ‚ç‚¹;
  â– in/out ä»…å¯¹èŠ‚ç‚¹ååŒ¹é…ç”Ÿæ•ˆ, å¤šå‚æ•°(é€»è¾‘"æˆ–")ç”¨ "+", é€»è¾‘"ä¸"ç”¨ "." è¡¨ç¤º;
  â– regex/regout å¯¹èŠ‚ç‚¹çš„å®Œæ•´ä¿¡æ¯è¿›è¡ŒåŒ¹é…(ç±»å‹ã€ç«¯å£ã€åŠ å¯†ç­‰);
  â– ç¤ºèŒƒ: "in=é¦™æ¸¯.0\.2å€ç‡+å°æ¹¾&out=BGP&regex=iplc"
â¦¿ rename é‡å‘½å, "æ—§å@æ–°å", "å‰ç¼€@", "@åç¼€", ç”¨ "+" è¿æ¥å¤šä¸ªå‚æ•°;
  â– åˆ é™¤å­—æ®µ: "å­—æ®µ1.å­—æ®µ2â˜ ï¸", æƒ³åˆ é™¤ "." æ—¶ç”¨ "\." æ›¿ä»£
  â– ç¤ºèŒƒ: "rename=é¦™æ¸¯@ğ‡ğŠ+[ğ’ğ’]@+@[1ğ—]+æµé‡.0\.2â˜ ï¸"
  â– é»˜è®¤ emoji å…ˆç”Ÿæ•ˆ, å¦‚æƒ³è°ƒæ¢é¡ºåº, è¯·ç”¨ rrname å‚æ•°
â¦¿ replace æ­£åˆ™æ›¿æ¢èŠ‚ç‚¹ä¸­å­—æ®µ, å¯ç”¨äºé‡å‘½å/æ›´æ”¹åŠ å¯†æ–¹å¼ç­‰
  â– replace=regex1@ğ˜€ğ˜ğ—¿1+regex2@ğ˜€ğ˜ğ—¿2
â¦¿ ptn/npt=1-8, å°†èŠ‚ç‚¹åè‹±æ–‡/æ•°å­—æ›¿æ¢æˆæ ·å¼ â‡’ ğŸ…°/ğŸ„°/ğ€/ğ—®/ğ”¸/ğ•’/áµƒ/á´¬, â‘ \â¶\â“µ\ğŸ™\Â¹\â‚\ğŸ\ğŸ·
â¦¿ delreg, åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åˆ é™¤ "èŠ‚ç‚¹å" ä¸­çš„å­—æ®µ(âš ï¸ æ…ç”¨)
â¦¿ aead=-1, å…³é—­ Vmess çš„ AEAD å‚æ•°
â¦¿ host=xxx, ä¿®æ”¹å·²æœ‰ host , å¦‚è¦å¢åŠ hostï¼Œè¯·ç”¨â˜ ï¸ç»“å°¾
â¦¿ obfs=vhttp/shttp, æŒ‡å®š obfs=shadowsocks-http æˆ– obfs=vmess-http çš„ç‰¹æ®Šéœ€æ±‚
â¦¿ tsession=0/1/2, 0/1 ä»£è¡¨å…³é—­ tls-session-ticket/reuseï¼Œ2 è¡¨ç¤ºå…¨éƒ¨å…³é—­
â¦¿ checkurl=xxx , æŒ‡å®š server_check_url å‚æ•°
â¦¿ sort=1/-1/x/å‚æ•°è§„åˆ™, æŒ‰èŠ‚ç‚¹å æ­£/é€†/éšæœº/å‚æ•°è§„åˆ™ æ’åº
  â– å‚æ•°è§„åˆ™æ˜¯æ­£åˆ™è¡¨è¾¾å¼æˆ–ç®€å•å…³é”®è¯, ç”¨"<" æˆ– ">" è¿æ¥
  â– sort=ğŸ‡­ğŸ‡°>ğŸ‡¸ğŸ‡¬>ğŸ‡¯ğŸ‡µ>ğŸ‡ºğŸ‡¸ , é å‰æ’åº
  â– sort=IEPL<IPLC<BGP , é åæ’åº
â¦¿ info=1, å¼€å¯é€šçŸ¥æç¤ºæœºåœº âœˆï¸ æµé‡ä¿¡æ¯(å¦‚æœ‰æä¾›);
â¦¿ flow=2022-06-02:1000:54, è®¢é˜…åˆ°æœŸæ—¶é—´:æ€»æµé‡:å·²ç”¨æµé‡
â¦¿ å ä½ç¬¦ï¼Œå¯ç”¨äº rename/replace ç­‰æ“ä½œ
  â– $type0/1/2/3/4/5/6/7 å ä½ç¬¦ï¼Œå°†èŠ‚ç‚¹ç±»å‹(ss/ssr/vmess ç­‰)ä½œä¸ºå¯æ“ä½œå‚æ•°ï¼Œå¦‚
    âˆ rename=@|$type2
    âˆ æ ·å¼åˆ†åˆ«ä¸º "ğ¬ğ¬","ğ’ğ’","ğŸ…¢ğŸ…¢","ğŸ†‚ğŸ†‚","â“¢â“¢","ğŸ…‚ğŸ…‚","ğ•Šğ•Š","Ë¢Ë¢"
  â– $index0/1/2/3/4/5/6/7/8 å ä½ç¬¦ï¼Œå°†èŠ‚ç‚¹çš„åºå·ä½œä¸ºå¯æ“ä½œå‚æ•°ï¼Œå¦‚
    âˆ rename=@ã€Œ$index1ã€
    âˆ æ ·å¼åˆ†åˆ«ä¸º 1\â‘ \â¶\â“µ\ğŸ™\Â¹\â‚\ğŸ\ğŸ·
  â– $emoji1/2 å ä½ç¬¦, å°†emoji(ğŸ‡­ğŸ‡° ç­‰)ä½œä¸ºå¯æ“ä½œå‚æ•°
    âˆ rename=@ã€Œ$emoji1ã€
  â– $tag å ä½ç¬¦ï¼Œå°†è®¢é˜…çš„ tag ä½œä¸ºå¯æ“ä½œå‚æ•°ï¼Œå¦‚
    âˆ å¯æ¥æ•°å­—ä»¥å•ç‹¬ç»™ tag æ·»åŠ å­—æ¯/æ•°å­—æ ·å¼
    âˆ rename=@ã€Œ$tag34ã€, æ ·å¼åŒä¸‹è¾¹çš„ ptn/npt
â¦¿ âŸ¦è¿›é˜¶å‚æ•°âŸ§: ğ˜€ğ—³ğ—¶ğ—¹ğ˜ğ—²ğ—¿/ğ˜€ğ—¿ğ—²ğ—»ğ—®ğ—ºğ—², ä¼ å…¥ä¸€æ®µ base64 ç¼–ç çš„è„šæœ¬, å¯ç”¨äºæ›´ä¸ºå¤æ‚çš„[è¿‡æ»¤/é‡å‘½å] éœ€æ±‚
  â– è¯´æ˜: https://github.com/KOP-XIAO/QuantumultX/pull/9

2âƒ£ï¸ âŸ¦ğ«ğğ°ğ«ğ¢ğ­ğ é‡å†™âŸ§/âŸ¦ğŸğ¢ğ¥ğ­ğğ« åˆ†æµâŸ§ â  å‚æ•°è¯´æ˜:
â¦¿ in, out, æ ¹æ®å…³é”®è¯ ä¿ç•™/ç¦ç”¨ ç›¸å…³åˆ†æµã€é‡å†™è§„åˆ™;
â¦¿ inhn, outhn, â€œä¿ç•™/åˆ é™¤â€ä¸»æœºå(ğ’‰ğ’ğ’”ğ’•ğ’ğ’‚ğ’ğ’†);
  â– ç¤ºèŒƒ: ç¦ç”¨ "æ·˜å®æ¯”ä»·" åŠ "weibo" çš„ js åŒä¸»æœºå
  ğ¡ğ­ğ­ğ©ğ¬://ğ¦ğ²ğ¥ğ¢ğ¬ğ­#out=tb_price.js+wb_ad.js&outhn=weibo
â¦¿ regex/regout, æ­£åˆ™ä¿ç•™/åˆ é™¤, è¯·è‡ªè¡ŒæŠ˜è…¾æ­£åˆ™è¡¨è¾¾å¼;
  â– å¯ä¸ in(hn)/out(hn) ä¸€èµ·ä½¿ç”¨ï¼Œin(hn)/out(hn) ä¼šä¼˜å…ˆæ‰§è¡Œ;
  â– å¯¹ ğ’‰ğ’ğ’”ğ’•ğ’ğ’‚ğ’ğ’† & ğ«ğğ°ğ«ğ¢ğ­ğ/ğŸğ¢ğ¥ğ­ğğ« åŒæ—¶ç”Ÿæ•ˆ(âš ï¸ æ…ç”¨)
â¦¿ policy å‚æ•°, ç”¨äºç›´æ¥æŒ‡å®šç­–ç•¥ç»„ï¼Œæˆ–ä¸º ğ’ğ®ğ«ğ ğ ç±»å‹ ğ—¿ğ˜‚ğ—¹ğ—²-ğ˜€ğ—²ğ˜ ç”Ÿæˆç­–ç•¥ç»„(é»˜è®¤"ğ’ğ¡ğšğ°ğ§"ç­–ç•¥ç»„);
â¦¿ pset=regex1@policy1+regex2@policy2, ä¸ºåŒä¸€åˆ†æµè§„åˆ™ä¸­ä¸åŒå…³é”®è¯(å…è®¸æ­£åˆ™è¡¨è¾¾å¼)æŒ‡å®šä¸åŒç­–ç•¥ç»„;
â¦¿ replace å‚æ•°, æ­£åˆ™æ›¿æ¢ ğŸğ¢ğ¥ğ­ğğ«/ğ«ğğ°ğ«ğ¢ğ­ğ å†…å®¹, regex@newregex;
  â– å°†æ·˜å®æ¯”ä»·ä¸­è„šæœ¬æ›¿æ¢æˆ lite ç‰ˆæœ¬(å¦‚æœ‰æ­¤ç‰ˆæœ¬çš„è„šæœ¬)
    âˆ replace=(price)(.*)@$1_lite$2
â¦¿ dst=rewrite/filterï¼Œåˆ†åˆ«ä¸ºå°† ğ¦ğ¨ğğ®ğ¥ğ&ğ—¿ğ˜‚ğ—¹ğ—²-ğ˜€ğ—²ğ˜ è½¬æ¢æˆ é‡å†™/åˆ†æµ;
  â– âš ï¸ é»˜è®¤å°† ğ¦ğ¨ğğ®ğ¥ğ è½¬æ¢åˆ°é‡å†™, ğ—¿ğ˜‚ğ—¹ğ—²-ğ˜€ğ—²ğ˜ è½¬æˆåˆ†æµ
  â– âš ï¸ æŠŠ ğ—¿ğ˜‚ğ—¹ğ—²-ğ˜€ğ—²ğ˜ ä¸­ url-regex è½¬æˆé‡å†™æ—¶, å¿…é¡»è¦åŠ  dst=rewrite;
  â– âš ï¸ æŠŠ ğ¦ğ¨ğğ®ğ¥ğ ä¸­çš„åˆ†æµè§„åˆ™è½¬æ¢æ—¶, å¿…é¡»è¦åŠ  dst=filter
â¦¿ cdn=1, å°† github è„šæœ¬çš„åœ°å€è½¬æ¢æˆå…ç¿»å¢™ fastly.jsdelivr.net/gh
â¦¿ fcr=1/2/3, ä¸ºåˆ†æµè§„åˆ™æ·»åŠ  force-cellular/multi-interface/multi-interface-balance å‚æ•°ï¼Œå¼ºåˆ¶ç§»åŠ¨æ•°æ®/æ··åˆæ•°æ®/è´Ÿè½½å‡è¡¡
â¦¿ via=æ¥å£, ä¸ºåˆ†æµè§„åˆ™æ·»åŠ  via-interface å‚æ•°, 0 è¡¨ç¤º via-interface=%TUN%
â¦¿ relay=ç›®æ ‡ç­–ç•¥å, æ‰¹é‡å°†èŠ‚ç‚¹è®¢é˜…è½¬æ¢ä¸ºip/hostè§„åˆ™ï¼Œç”¨äºå®ç°ä»£ç†é“¾

3âƒ£ï¸ å…¶ä»–å‚æ•°
â¦¿ é€šçŸ¥å‚æ•° ntf=0/1, ç”¨äº å…³é—­/æ‰“å¼€ èµ„æºè§£æå™¨çš„æç¤ºé€šçŸ¥
  â– ğ—¿ğ—²ğ˜„ğ—¿ğ—¶ğ˜ğ—²/ğ—³ğ—¶ğ—¹ğ˜ğ—²ğ—¿ é»˜è®¤â€œå¼€å¯â€é€šçŸ¥æç¤º, ä»¥é˜²è§„åˆ™è¯¯åˆ é™¤
  â– ğ˜€ğ—²ğ—¿ğ˜ƒğ—²ğ—¿ èµ„æºè§£æåˆ™é»˜è®¤â€å…³é—­â€œé€šçŸ¥æç¤º
â¦¿ ç±»å‹å‚æ•° type=domain-set/rule/module/list/nodes
  â– å½“è§£æå™¨æœªèƒ½æ­£ç¡®è¯†åˆ«ç±»å‹æ—¶, å¯å°è¯•ä½¿ç”¨æ­¤å‚æ•°å¼ºåˆ¶æŒ‡å®š
â¦¿ éšè—å‚æ•° hide=0, ç¦ç”¨ç­›é™¤çš„åˆ†æµ/é‡å†™ï¼Œé»˜è®¤æ–¹å¼ä¸ºåˆ é™¤
â¦¿ profile=111 , URL-Scheme æ·»åŠ  QuanX ç±»å‹é…ç½®ä¸­è¿œç¨‹èµ„æº
----------------------------------------------------------
*/

/**
* ä½¿ç”¨è¯´æ˜ï¼Œ
0ï¸âƒ£ åœ¨QuantumultX é…ç½®æ–‡ä»¶ä¸­[general] éƒ¨åˆ†ï¼ŒåŠ å…¥ 
resource_parser_url = https://raw.githubusercontent.com/KOP-XIAO/QuantumultX/master/Scripts/resource-parser.js
âš ï¸âš ï¸å¦‚æç¤º"æ²¡æœ‰è‡ªå®šä¹‰è§£æå™¨"ï¼Œè¯·é•¿æŒ‰å³ä¸‹è§’å›¾æ ‡åç‚¹å‡»å·¦ä¾§åˆ·æ–°æŒ‰é’®ï¼Œæ›´æ–°èµ„æºï¼Œåå°é€€å‡º appï¼Œç›´åˆ°å‡ºç°è§£æå™¨è¯´æ˜

------------------------------
*/
var Pemoji = mark0 && para1.indexOf("emoji=") != -1 ? para1.split("emoji=")[1].split("&")[0] : null;
var Pdbg = mark0 && para1.indexOf("dbg=") != -1 ? para1.split("dbg=")[1].split("&")[0] : null;
var Pudp0 = mark0 && para1.indexOf("udp=") != -1 ? para1.split("udp=")[1].split("&")[0] : 0;
var Ptfo0 = mark0 && para1.indexOf("tfo=") != -1 ? para1.split("tfo=")[1].split("&")[0] : 0;
//var Prname = mark0 && para1.indexOf("rename=") != -1 ? para1.split("rename=")[1].split("&")[0].split("+") : null;
var Prname = mark0 && /(^|\&)rename=/.test(para1) ? para1.split(/(^|\&)rename\=/)[2].split("&")[0].split("+") : null;
var Psrename = mark0 && para1.indexOf("srename=") != -1 ? Base64.decode(para1.split("srename=")[1].split("&")[0]) : null; // script rename
var Prrname = mark0 && para1.indexOf("rrname=") != -1 ? para1.split("rrname=")[1].split("&")[0].split("+") : null;
var Psuffix = mark0 && para1.indexOf("suffix=") != -1 ? para1.split("suffix=")[1].split("&")[0] : 0;
var Ppolicy = mark0 && para1.indexOf("policy=") != -1 ? decodeURIComponent(para1.split("policy=")[1].split("&")[0]) : "Shawn";
var Ppolicyset = mark0 && para1.indexOf("pset=") != -1 ? decodeURIComponent(para1.split("pset=")[1].split("&")[0]) : "";
var Pcert0 = mark0 && para1.indexOf("cert=") != -1 ? para1.split("cert=")[1].split("&")[0] : 0;
var Psort0 = mark0 && para1.indexOf("sort=") != -1 ? para1.split("sort=")[1].split("&")[0] : 0;
var PsortX = mark0 && para1.indexOf("sortx=") != -1 ? para1.split("sortx=")[1].split("&")[0] : 0;
var PTls13 = mark0 && para1.indexOf("tls13=") != -1 ? para1.split("tls13=")[1].split("&")[0] : 0;
var Pntf0 = mark0 && para1.indexOf("ntf=") != -1 ? para1.split("ntf=")[1].split("&")[0] : 2;
var Phide = mark0 && para1.indexOf("hide=") != -1 ? para1.split("hide=")[1].split("&")[0] : 1;
var Pb64 = mark0 && para1.indexOf("b64=") != -1 ? para1.split("b64=")[1].split("&")[0] : 0;
var emojino = [" 0ï¸âƒ£ ", " 1âƒ£ï¸ ", " 2âƒ£ï¸ ", " 3âƒ£ï¸ ", " 4âƒ£ï¸ ", " 5âƒ£ï¸ ", " 6âƒ£ï¸ ", " 7âƒ£ï¸ ", " 8âƒ£ï¸ ", " 9âƒ£ï¸ ", " ğŸ”Ÿ "]
var pfi = mark0 &&Pin0 ? "in=" + Pin0.join(", ") + ",  " : ""
var pfo = mark0 &&Pout0 ? "out=" + Pout0.join(", ") : ""
var pfihn = mark0 &&Phin0 ? "inhn=" + Phin0.join(", ") + ",  " : ""
var pfohn = mark0 &&Phout0 ? "outhn=" + Phout0.join(", ") : ""
var Pcnt =  mark0 &&para1.indexOf("cnt=") != -1 ? para1.split("cnt=")[1].split("&")[0] : 0;
var Pcap = mark0 &&para1.indexOf("cap=") != -1 ? para1.split("cap=")[1].split("&")[0] : "";
var Pptn = mark0 &&para1.indexOf("ptn=") != -1 ? para1.split("ptn=")[1].split("&")[0] : ""; //èŠ±å¼è‹±æ–‡å­—ç¬¦
var Pnptn = mark0 &&para1.indexOf("npt=") != -1 ? para1.split("npt=")[1].split("&")[0] : ""; //èŠ±å¼æ•°å­—
var Pcdn = mark0 &&para1.indexOf("cdn=") != -1 ? para1.split("cdn=")[1].split("&")[0] : "";
let [flow, exptime, errornode, total] = "";
var Pdel = mark0 && para1.indexOf("del=") != -1 ? para1.split("del=")[1].split("&")[0] : 0; //åˆ é™¤é‡å¤èŠ‚ç‚¹
var typeU = mark0 && para1.indexOf("type=") != -1 ? para1.split("type=")[1].split("&")[0] : "";
var Pfcr = mark0 && para1.indexOf("fcr=") != -1 ? para1.split("fcr=")[1].split("&")[0] : ""; // force-cellular ç­‰å‚æ•°
var Pvia = mark0 && para1.indexOf("via=") != -1 ? para1.split("via=")[1].split("&")[0] : ""; // via-interface å‚æ•°
var Paead = mark0 && para1.indexOf("aead=") != -1 ? para1.split("aead=")[1].split("&")[0] : ""; // vmess aead å‚æ•°
var Phost = mark0 && ( para.indexOf("#host=") != -1 || para.indexOf("&host=") != -1) ? (para.indexOf("#host=")!=-1? para.split("#host="): para.split("&host="))[1].split("&")[0] : ""; // host æ··æ·†å‚æ•°
var Pcsha256 = mark0 && para1.indexOf("csha=") != -1 && version >= 646? para1.split("csha=")[1].split("&")[0] : ""; // cert-sha256 æ··æ·†å‚æ•°
var Ppsha256 = mark0 && para1.indexOf("psha=") != -1 && version >= 646? para1.split("psha=")[1].split("&")[0] : ""; // pubkey-sha256 æ··æ·†å‚æ•°
var typeQ = $resource.type? $resource.type:"unsupported"   //è¿”å› field ç±»å‹å‚æ•°
var PRelay =mark0 && para1.indexOf("relay=") != -1 ? decodeURIComponent(para1.split("relay=")[1].split("&")[0]) : ""; // èŠ‚ç‚¹ relay å‚æ•°, ç”¨äºå®ç°ä»£ç†é“¾åŠŸèƒ½
var PUOT = mark0 && para1.indexOf("uot=") != -1 && version >= 665? para1.split("uot=")[1].split("&")[0] : ""; // èŠ‚ç‚¹ udp-over-tcp å¼€å¯
var PcheckU = mark0 && para1.indexOf("checkurl=") != -1 ? decodeURIComponent(para1.split("checkurl=")[1].split("&")[0]) : ""; // èŠ‚ç‚¹ server_check_url å‚æ•°
typeQ = PRelay!=""? "server":typeQ
var typec="" //check result type
var Pflow=mark0 && para1.indexOf("flow=") != -1 ? para1.split("flow=")[1].split("&")[0] : 0; // æµé‡æ—¶é—´ç­‰å‚æ•°
var PProfile = mark0 && para1.indexOf("profile=") != -1 ? para1.split("profile=")[1].split("&")[0] : 0; // é€šè¿‡URL-Schemeå¯¼å…¥å®Œæ•´é…ç½®å‚æ•°
var Palpn = mark0 && para1.indexOf("alpn=") != -1 && version >= 712? para1.split("alpn=")[1].split("&")[0] : ""; // over-tls ç±»å‹ï¼Œalpnå‚æ•°
var Pobfs = mark0 && para1.indexOf("obfs=") != -1 && version >= 770? para1.split("obfs=")[1].split("&")[0] : ""; // æŒ‡å®šç‰¹æ®Šæƒ…å†µä¸‹çš„ obfs=xx-http ç±»å‹
var Psession =  mark0 && para1.indexOf("tsession=") != -1 && version >= 771? para1.split("tsession=")[1].split("&")[0] : "";//tls-no-session-ticket and tls-no-session-reuse
// 0/1 ä»£è¡¨å…³é—­ session-ticket/reuseï¼Œ2 è¡¨ç¤ºå…¨éƒ¨å…³é—­ã€‚

var RegoutList= [] ;//ç”¨äº regoutå‚æ•°åˆ é€‰æé†’
// URL-Scheme å¢åŠ é…ç½®
var ADDres = `quantumult-x:///add-resource?remote-resource=url-encoded-json`
var RLink = `{
  "server_remote": [
    sremoteposition
  ],
  "filter_remote": [
    fremoteposition
  ],
  "rewrite_remote": [
    rremoteposition
  ]
}`

var ProfileInfo = {
  "server":"",
  "filter":"",
  "rewrite":""
}
  return  cnts
  }
    return fn();
  } catch (error) {
    return defaultVaule;
  }
  return total
  
}
    return type
}
    return Nlist
}
  return cnt
}
    return " " + cnt + " "
  }
    return cnt
  }
  return cnt 
}
  return cnt
}
  }    return newStr.join(" ");
}
    return [[item.split("tag=")[0]+
      "tag=", tp, item.split("tag=")[1]].join(" ")].join(" ")
  }
    return [item, tp].join(" ")
  }
    return tp
  }
  return item
}
  return items
}
  return item
}
    return get_emoji(ind,item.split("tag=")[1])[1]
  }
  return item
}
  return cnt0
}
  return rsts.join("\n")
  
}
    return cnt.replace(/(.*js-file-line\"\>)(.*?)(\<\/td\>)/g,"$2").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").trim()
  }
  return cnt
}
  return "wrong-link"
}
  return cnt
}
  return cnt
}
  return cnt
}
  return cnt
}
  return cnt
}
  return cnt
}
        return row.replace(/ /g, "").split("data=")[0].split("data-type=")[0] + " url " + "reject-dict"
    } else if (/array/i.test(filename)) {
        return row.replace(/ /g, "").split("data=")[0].split("data-type=")[0] + " url " + "reject-array"
    } else if (/(txt|html)/i.test(filename) || filename==null) {
        return row.replace(/ /g, "").split("data=")[0].split("data-type=")[0] + " url " + "reject-200"
    } else if (/(png|jpg|gif)/i.test(filename)) {
        return row.replace(/ /g, "").split("data=")[0].split("data-type=")[0] + " url " + "reject-img"
    } else {
        return row.replace(/ /g, "").split("data=")[0].split("data-type=")[0] + " url " + "reject"
    }
    return nrw
}
  return nrw
}
    return nrwt
}
    return Nlist
}
    return hname
}
        return flag
    } else { //if param
        return 2
    } //æ— å‚æ•°
}
        //return nlist;
    } else if (Tin != "" && Tin != null) { //if Tout
        var dlist = [];
        for (var i = 0; i < cnt.length; i++) {
            cc = cnt[i].replace(/^\s*\-\s/g,"").trim()
            const RuleCheck = (item) => cc.indexOf(item) != -1; //æ— è§†æ³¨é‡Šè¡Œ
            const CommentCheck = (item) => cc.toLowerCase().indexOf(item) == 0; //æ— è§†æ³¨é‡Šè¡Œ
            if (!RuleK.some(CommentCheck) && cc) { //if Pout.some, ä¸æ“ä½œæ³¨é‡Šé¡¹
                dd = Rule_Policy(cc);
                const include = (item) => dd.indexOf(item) != -1; // ä¿ç•™é¡¹
                if (Tin.some(include)) {
                    nlist.push(dd);
                } else { dlist.push("-" + dd) }
            }
      //return nlist;
    } else {  //if Tin
      nlist = cnt.map(Rule_Policy)
        //return cnt.map(Rule_Policy)
    }
  return nlist
}
            return ""
        } else { return "" }
        if (cnt[0].indexOf("URL-REGEX") != -1 || cnt[0].indexOf("PROCESS") != -1) {
            nn = ""
        } else { nn = nn.replace("IP-CIDR6", "ip6-cidr") }
        return nn
    } else if (cnt.length == 1 && !RuleK.some(RuleCheck) && cnt[0]!="" && cnt[0].indexOf("payload:")==-1 && cnt[0].indexOf("=")==-1 && cnt[0].trim()!="https:") { // çº¯åŸŸå/ip åˆ—è¡¨
      //$notify("LIST-HANDLE")
      return rule_list_handle(cnt[0])
    } else { 
      //$notify("Nothing")
      return "" }//if RuleK1 check 
}
  return cnt
}
    return nlist.join("\n")
}
  return cnt
  console.log(cnt)
}
    return cnt.join(",")
  }
    return cnt0//.split("\n")
}
    return QXlist;
}
  return cnt
}
  return cnt
}
  return cnt
}
  return nodes.join("\n")
  //console.log(nodes)
}
    return QX
}
  return node
}
  return node
}
  return QX
}
  return QX
}
    return obfsi.join(", ")
  } else if (jsonl.net == "ws") {
    obfs0 = "obfs=ws";
    uri0 = jsonl.path && jsonl.path != "" ? "obfs-uri=" + jsonl.path : "obfs-uri=/";
    uri0 = uri0.indexOf("uri=/")!=-1 ? uri0:uri0.replace("uri=","uri=/")
    host0 = jsonl.host && jsonl.host != "" ? "obfs-host=" + jsonl.host + ", " : "";
    obfsi.push(obfs0, host0 + uri0);
    return obfsi.join(", ")
  } else if (jsonl.tls == "tls" && (jsonl.net == "tcp" || jsonl.net == "none")) { // è¿‡æ»¤æ‰ h2/http ç­‰ç±»å‹ 
    obfs0 = "obfs=over-tls, " + tcert + ", " + tls13;
    uri0 = jsonl.path && jsonl.path != "" ? "obfs-uri=" + jsonl.path : "";
    uri0 = uri0.indexOf("uri=/")!=-1 ? uri0:uri0.replace("uri=","uri=/")
    host0 = jsonl.host && jsonl.host != "" ? ", obfs-host=" + jsonl.host : "";
    obfsi.push(obfs0 + host0)
    return obfsi.join(", ")
  } else if ((jsonl.net == "tcp" || jsonl.net == "none") && jsonl.type == "http"){
    obfs0 = "obfs=http";
    uri0 = jsonl.path && jsonl.path != "" ? "obfs-uri=" + jsonl.path : "obfs-uri=/";
    uri0 = uri0.indexOf("uri=/")!=-1 ? uri0:uri0.replace("uri=","uri=/")
    host0 = jsonl.host && jsonl.host != "" ? "obfs-host=" + jsonl.host + ", " : "";
    obfsi.push(obfs0, host0 + uri0);
    return obfsi.join(", ")
  } else if (jsonl.net !="tcp" && jsonl.net !="none" &&  jsonl.net != undefined){ // è¿‡æ»¤æ‰ h2/http ç­‰ç±»å‹
    Perror = 1
    $notify("âš ï¸ Quantumult X ä¸æ”¯æŒè¯¥ç±»å‹èŠ‚ç‚¹", "vmess + " + jsonl.net, JSON.stringify(jsonl))
    return "NOT-SUPPORTTED"
  } else if ((jsonl.net == "tcp" || jsonl.net == "none") && jsonl.type != undefined && jsonl.type != "none" && jsonl.type != "" && jsonl.type != "vmess") {
    return "NOT-SUPPORTTED"
  } else {return ""}
}
    return cnt
}
    return cnt
}
        return content
    }
    return content
  } else {
    RegoutList.push(cnt)
  }
        return flag
    } else { //if param
        return 2
    }
    return Nlist
}
        return res;
    } catch (err) {
        $notify("âŒ è„šæœ¬ç­›é€‰å‡ºç°é”™è¯¯", "", err);
        return servers;
    }
    return QX;
}
  return QX
}
    return QX;
}
  return total+":"+item
}
  return QX;
}
    return QX;
}
  return cntii
} catch (err) {
  if(Perror == 0) {
  $notify("âŒ è§£æå‡ºç°é”™è¯¯,å·²å¿½ç•¥è¯¥æ¡ç›®", "âš ï¸ è¯·ç‚¹å‡»é€šçŸ¥ï¼Œå‘é€è®¢é˜…é“¾æ¥è¿›è¡Œåé¦ˆ", cntf+"\n"+ err, bug_link);
}
  return ""
}
   return nlist
}
  return cnt0
}
        return nlist.sort(ToTag)
    } else if (para == -1) {
        return nlist.sort(ToTagR)
    } else if(para == "x") {
        return shuffle(nlist)
    } else if(para == "0") {
        return nlist
    } else {
      return Sort_KWD (nlist,para) //å…³é”®è¯æ’åº
    }
    return res
}
    return res
}
    return input;
}
  return newarr
}
  return cnt0
}
    return cnt
}
      return nserver
    } else {
      return server
    }
        return servers.map((s, i) => s.split("tag=")[0] + "tag=" + newNames[i]);
    } catch (err) {
        $notify("âŒ è„šæœ¬é‡å‘½åå‡ºç°é”™è¯¯", "", err);
        return servers;
    }
    return str.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/g, "").trim();//unescape(escape(str).replace(/\%uD.{3}/g, ''));
}
                return [nname,key]
            }
    if (flag == 0) { return ["ğŸ´â€â˜ ï¸ " + sname.replace(/[\uD83C][\uDDE6-\uDDFF][\uD83C][\uDDE6-\uDDFF]/g, "").trim(), "ğŸ´â€â˜ ï¸"] }
}
function emoji_handle(servers, Pemoji) {
    var nlist = []
    var ser0 = servers

    for (var i = 0; i < ser0.length; i++) {
        if (ser0[i].indexOf("tag=") != -1) {
            var oname = ser0[i].split("tag=")[1].trim();
            var hd = ser0[i].split("tag=")[0];
            var nname = oname;//emoji_del(oname);
            // Code: https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2, Emoji: https://emojipedia.org/flags/
            if (Pemoji == 1) {
                var nname = get_emoji(1, nname)[0]
            } else if (Pemoji == 2) {
                var nname = get_emoji(2, nname)[0]
            } else if (Pemoji == -1) {
                nname = emoji_del(oname);
            }
    return nlist
}
  return (Nlist)
}
    return nserver
}
    return nserver
}
    return nserver
}
        return content
    }
    return "false"
  } else {
      //console.log(para)
    return content.split(para+"=")[1].split(",")[0].trim()
  }
  return nserver
}
  return nserver
}
  return nserver
}
  return node
}
  return node
}
  return node
}
  return node
}
  return cnt
}
    return cnt
  }
  return nodelist.join("\n")
}
  return node
}
  return node
}
  return node
}
  return node

}
    return node
}
    return node
}
  return cnt0
}
    return cnt0
}
  return cnt
}
        return t;
    }(b64chars);
    var fromCharCode = String.fromCharCode;
    // encoder stuff
    var cb_utob = function (c) {
        if (c.length < 2) {
            var cc = c.charCodeAt(0);
            return cc < 0x80 ? c
                : cc < 0x800 ? (fromCharCode(0xc0 | (cc >>> 6))
                    + fromCharCode(0x80 | (cc & 0x3f)))
                    : (fromCharCode(0xe0 | ((cc >>> 12) & 0x0f))
                        + fromCharCode(0x80 | ((cc >>> 6) & 0x3f))
                        + fromCharCode(0x80 | (cc & 0x3f)));
        } else {
            var cc = 0x10000
                + (c.charCodeAt(0) - 0xD800) * 0x400
                + (c.charCodeAt(1) - 0xDC00);
            return (fromCharCode(0xf0 | ((cc >>> 18) & 0x07))
                + fromCharCode(0x80 | ((cc >>> 12) & 0x3f))
                + fromCharCode(0x80 | ((cc >>> 6) & 0x3f))
                + fromCharCode(0x80 | (cc & 0x3f)));
        }
        return u.replace(re_utob, cb_utob);
    };
    var cb_encode = function (ccc) {
        var padlen = [0, 2, 1][ccc.length % 3],
            ord = ccc.charCodeAt(0) << 16
                | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)
                | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),
            chars = [
                b64chars.charAt(ord >>> 18),
                b64chars.charAt((ord >>> 12) & 63),
                padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),
                padlen >= 1 ? '=' : b64chars.charAt(ord & 63)
            ];
        return chars.join('');
    };
    var btoa = function (b) {
        return b.replace(/[\s\S]{1,3}/g, cb_encode);
    };
    // var _encode = function(u) {
    //  var isUint8Array = Object.prototype.toString.call(u) === '[object Uint8Array]';
    //  return isUint8Array ? u.toString('base64')
    //    : btoa(utob(String(u)));
    // }
    this.encode = function (u) {
        var isUint8Array = Object.prototype.toString.call(u) === '[object Uint8Array]';
        return isUint8Array ? u.toString('base64')
            : btoa(utob(String(u)));
    }
        return !urisafe
            ? _encode(u)
            : _encode(String(u)).replace(/[+\/]/g, function (m0) {
                return m0 == '+' ? '-' : '_';
            }).replace(/=/g, '');
    };
    var encodeURI = function (u) { return uriencode(u, true) };
    // decoder stuff
    var re_btou = /[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g;
    var cb_btou = function (cccc) {
        switch (cccc.length) {
            case 4:
                var cp = ((0x07 & cccc.charCodeAt(0)) << 18)
                    | ((0x3f & cccc.charCodeAt(1)) << 12)
                    | ((0x3f & cccc.charCodeAt(2)) << 6)
                    | (0x3f & cccc.charCodeAt(3)),
                    offset = cp - 0x10000;
                return (fromCharCode((offset >>> 10) + 0xD800)
                    + fromCharCode((offset & 0x3FF) + 0xDC00));
            case 3:
                return fromCharCode(
                    ((0x0f & cccc.charCodeAt(0)) << 12)
                    | ((0x3f & cccc.charCodeAt(1)) << 6)
                    | (0x3f & cccc.charCodeAt(2))
                );
            default:
                return fromCharCode(
                    ((0x1f & cccc.charCodeAt(0)) << 6)
                    | (0x3f & cccc.charCodeAt(1))
                );
        }
        return b.replace(re_btou, cb_btou);
    };
    var cb_decode = function (cccc) {
        var len = cccc.length,
            padlen = len % 4,
            n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)
                | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)
                | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0)
                | (len > 3 ? b64tab[cccc.charAt(3)] : 0),
            chars = [
                fromCharCode(n >>> 16),
                fromCharCode((n >>> 8) & 0xff),
                fromCharCode(n & 0xff)
            ];
        chars.length -= [0, 0, 2, 1][padlen];
        return chars.join('');
    };
    var _atob = function (a) {
        return a.replace(/\S{1,4}/g, cb_decode);
    };
    var atob = function (a) {
        return _atob(String(a).replace(/[^A-Za-z0-9\+\/]/g, ''));
    };
    // var _decode = buffer ?
    //  buffer.from && Uint8Array && buffer.from !== Uint8Array.from
    //  ? function(a) {
    //    return (a.constructor === buffer.constructor
    //        ? a : buffer.from(a, 'base64')).toString();
    //  }
    //  : function(a) {
    //    return (a.constructor === buffer.constructor
    //        ? a : new buffer(a, 'base64')).toString();
    //  }
    //  : function(a) { return btou(_atob(a)) };
    var _decode = function (u) {
        return btou(_atob(u))
    }
        return _decode(
            String(a).replace(/[-_]/g, function (m0) { return m0 == '-' ? '+' : '/' })
                .replace(/[^A-Za-z0-9\+\/]/g, '')
        ).replace(/&gt;/g, ">").replace(/&lt;/g, "<");
    };
}
                return {
                        /* The block's parent */
                        parent: null,
                        /* Number of children */
                        length: 0,
                        /* Block's level */
                        level: lvl,
                        /* Lines of code to process */
                        lines: [],
                        /* Blocks with greater level */
                        children : [],
                        /* Add a block to the children collection */
                        addChild : function(obj) {
                                this.children.push(obj);
                                obj.parent = this;
                                ++this.length;
                        }
                                        return;
                                }
                return result;
        }
                        return true;
                } else if(val == 'false') {
                        return false;
                } else if(val == '.NaN') {
                        return Number.NaN;
                } else if(val == 'null') {
                        return null;
                } else if(val == '.inf') {
                        return Number.POSITIVE_INFINITY;
                } else if(val == '-.inf') {
                        return Number.NEGATIVE_INFINITY;
                } else if(m = val.match(regex["dashesString"])) {
                        return m[1];
                } else if(m = val.match(regex["quotesString"])) {
                        return m[1];
                } else if(m = val.match(regex["float"])) {
                        return parseFloat(m[0]);
                } else if(m = val.match(regex["integer"])) {
                        return parseInt(m[0]);
                } else if( !isNaN(m = Date.parse(val))) {
                        return new Date(m);
                } else if(m = val.match(regex["single_key_value"])) {
                        var res = {};
                        res[m[1]] = processValue(m[2]);
                        return res;
                } else if(m = val.match(regex["array"])){
                        var count = 0, c = ' ';
                        var res = [];
                        var content = "";
                        var str = false;
                        for(var j = 0, lenJ = m[1].length; j < lenJ; ++j) {
                                c = m[1][j];
                                if(c == '\'' || c == '"') {
                                        if(str === false) {
                                                str = c;
                                                content += c;
                                                continue;
                                        } else if((c == '\'' && str == '\'') || (c == '"' && str == '"')) {
                                                str = false;
                                                content += c;
                                                continue;
                                        }
                        return res;
                } else if(m = val.match(regex["map"])){
                        var count = 0, c = ' ';
                        var res = [];
                        var content = "";
                        var str = false;
                        for(var j = 0, lenJ = m[1].length; j < lenJ; ++j) {
                                c = m[1][j];
                                if(c == '\'' || c == '"') {
                                        if(str === false) {
                                                str = c;
                                                content += c;
                                                continue;
                                        } else if((c == '\'' && str == '\'') || (c == '"' && str == '"')) {
                                                str = false;
                                                content += c;
                                                continue;
                                        }
                        return newRes;
                } else 
                        return val;
        }
                return chunks.join("\n");
        }
                return str;
        }
                return res;
        }
                return res;
        }
                return lines.join("\n");
        }
                return res;
        }
        return regex.reduce((a, expr) => OR(a, src.map(item => expr.test(item))), initial)
    }
            return src.map(item => item.replace(old, now));
        },

        delete: (src, ...args) => {
            return src.map(item => args.reduce((now, expr) => now.replace(expr, ''), item));
        },

        trim: (src) => {
            return src.map(item => item.trim().replace(/[^\S\r\n]{2,}/g, ' '));
        }
                return type ? type[1] : 'unknown';
            })
        };
        return nodes;
    }
    return {
        filter, rename, getNodeInfo
    }
    return args.reduce((a, b) => a.map((c, i) => b[i] && c));
}
    return args.reduce((a, b) => a.map((c, i) => b[i] || c))
}
    return array.map(c => !c);
}
